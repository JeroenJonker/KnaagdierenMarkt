@page "/"
@inject HttpClient Http
@using Microsoft.AspNetCore.SignalR.Client
@using KnaagdierenMarktGame.Client.Components
@using KnaagdierenMarktGame.Client.Classes
@inject GameConnection gameConnection
@inject GameState gameState
@implements IDisposable

@if (gameState.CurrentState == Enums.States.Login)
{
    <Login />
}
else
{
    <Game />
}



@code {
    protected override async Task OnInitializedAsync()
    {
        gameState.OnPropertyChanged += UpdateScreen;
        await gameConnection.StartConnection();
    }

    public async Task UpdateScreen(object ob) => StateHasChanged();

    public bool IsConnected =>
    gameConnection.HubConnection.State == HubConnectionState.Connected;


    public void Dispose()
    {
        _ = gameConnection.HubConnection.DisposeAsync();
    }

}
